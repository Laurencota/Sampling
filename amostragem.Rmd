---
title: "Amostragem"
author: Lauren Mello Cota 
date: "01/02/2021"
output:
  html_document: default
---

\
\
\
```{r}
library(SDaA)
library(tidyverse)
set.seed(490)
```

**Banco de dados agpop**
O governo dos Estados Unidos realiza um recenseamento agr√≠cola de cinco em cinco  anos,  coletando  dados  em  todas  as  fazendas  (definido  como  qualquer lugar onde foram produzidos e vendidos ou mais de produtos agr√≠colas) nos 50 estados1. O Censo de Agricultura fornece dados sobre o n√∫mero de fazendas, a √°rea total dedicada √†s fazendas, ao tamanho da fazenda, ao rendimento de diferentes culturas e a uma grande variedade de outras medidas agr√≠colas para cada  um  dos  munic√≠pios  (localidades).  

**De forma similar como foi obtida a AASs, cada um gerar√° sua pr√≥pria AASs de tamanho 300 dessa mesma popula√ß√£o (utilize ‚Äúagpop‚Äù).**


Para obter um AAS de tamanho 300 dessa popula√ß√£o, geram-se 300 n√∫meros aleat√≥rios entre 0 e 1 no computador,
multiplicados cada um por 3078 e arredondados o resultado at√© o pr√≥ximo inteiro mais alto. Este procedimento gera um AASc. 


```{r message=FALSE, warning=FALSE}
data("agpop")
n_total = nrow(agpop)
vetor_zero_um = runif(300, 0, 1)

AASc = sample(vetor_zero_um, 300)*n_total
AASc = round(AASc)

rep =as.data.frame(AASc) %>% group_by(AASc) %>% 
  summarise(Num = n()) %>% filter(Num>1)
repetidos = rep$AASc
a_sortear = sum(rep$Num)- length(repetidos)

unicos = ifelse(AASc %in% repetidos,NA,AASc) %>% data.frame(Selecionados = .) %>% drop_na()

vec = 1:3078
vec_s = data.frame(VEC_S = ifelse(vec %in% unicos$Selecionados,NA,vec)) %>% drop_na()

ressorteio = sample(vec_s$VEC_S,a_sortear,replace = F) %>% data.frame(Selecionados=.)
AASs = unicos %>% rbind(repetidos %>% data.frame(Selecionados = .),ressorteio)

dados = agpop[AASs %>% as_vector(),]
head(dados)
```

\
\
\
\

- Estima√ß√£o da media e o total de acres das fazendas em 1992.

```{r}
# m√©dia de acres
media_acres = mean(dados$acres92)

# total de acres
total_acres = media_acres*n_total

paste0("Estima√ß√£o M√©dia Acres: ",media_acres);paste0("Estima√ß√£o Total Acres: ",total_acres)
```
\

- Estima√ß√£o da propor√ß√£o de localidades com menos de 200 mil acres em fazendas em 1992. 

```{r}
# propor√ß√£o = contagem com a carct de interrese / tot amostra

estimacao_prop = length(dados$acres92[dados$acres92 < 200000]) / nrow(dados)

print(paste0("Estima√ß√£o Propor√ß√£o de localidade com menos de 200 mil acres: ",estimacao_prop))
```
\

- Estima√ß√£o do total de fazendas em 1982, 1987 e 1992.

```{r}
# total de fazendas em 1982
faz_82 = mean(dados$farms82)*n_total

# total de fazendas em 1987
faz_87 = mean(dados$farms87)*n_total

# total de fazendas em 1992
faz_92 = mean(dados$farms92)*n_total

paste0("Estima√ß√£o Total de Fazendas em 1982: ",faz_82);paste0('Estima√ß√£o Total de Fazendas em 1987: ',faz_87);paste0('Estima√ß√£o Total de Fazendas em 1992: ',faz_92)

```
\

Atrav√©z das estimativas acima, podemos concluir que **o total de fazendas teve tend√™ncia de redu√ß√£o ao decorrer dos anos**. No ano de 1982 haviam cerca de 2.2 milh√µes de fazendas, ap√≥s dez anos este n√∫mero passou para 1.8 milh√£o, uma diferen√ßa consider√°vel!

**Isso vai de acordo com o esperado**, pois gra√ßas a revolu√ß√£o industrial ocorreu o fen√¥meno chamado **√™xodo rural**, caracterizado pela migra√ß√£o da popula√ß√£o do eixo rural para os centros urbanos e uma consequ√™ncia direta deste fen√¥meno foi a redu√ß√£o do n√∫mero de fazendas. Pelo fato de haver menos popula√ß√£o, logicamente haver√° menos fazendas, ent√£o nossas estimativas calculadas fazem todo sentido no nosso contexto. 

\
\
\
\


```{r}
dados_AASc = agpop[AASc,]
```


- Estima√ß√£o da m√©dia e o total de acres das fazendas em 1992.

```{r}
# m√©dia de acres
media_acres = mean(dados_AASc$acres92)

# total de acres
total_acres = media_acres*n_total

paste0("Estima√ß√£o M√©dia Acres: ",media_acres);paste0("Estima√ß√£o Total Acres: ",total_acres)
```
\

O resultado visto antiormente da estima√ß√£o da m√©dia de Acres das fazendas em 1992, com a amostragem **AASs** foi de aproximadamente 317284, da amostragem **AASc** foi de 298389. Resultados bem pr√≥ximos, n√£o mostrando efeito siginificativo da reposi√ß√£o. A estima√ß√£o do total seguiu a mesma linha: ambos est√£o pr√≥ximos de 9 milh√µes.

\
\

- Estima√ß√£o da propor√ß√£o de localidades com menos de 200 mil acres em fazendas em 1992. 

```{r}
# propor√ß√£o = contagem com a carct de interrese / tot pop

estimacao_prop = length(dados_AASc$acres92[dados_AASc$acres92 < 200000]) / nrow(dados_AASc)

print(paste0("Estima√ß√£o Propor√ß√£o de localidade com menos de 200 mil acres: ",estimacao_prop))
```
\

A estima√ß√£o dessa propo√ß√£o tamb√©m foi muito semelhante para as amostras AASs e AASc, estando pr√≥ximos de 0.5.

\
\

- Estima√ß√£o do total de fazendas em 1982, 1987 e 1992.

```{r}
# total de fazendas em 1982
faz_82 = mean(dados_AASc$farms82)*n_total

# total de fazendas em 1987
faz_87 = mean(dados_AASc$farms87)*n_total

# total de fazendas em 1992
faz_92 = mean(dados_AASc$farms92)*n_total

paste0("Estima√ß√£o Total de Fazendas em 1982: ",faz_82);paste0('Estima√ß√£o Total de Fazendas em 1987: ',faz_87);paste0('Estima√ß√£o Total de Fazendas em 1992: ',faz_92)

```
\

Os valores da estima√ß√£o do total de fazendas nos anos de 1982, 87 e 92 foram muito parecidos para AASs e AASc, seguindo o mesmo padr√£o de **redu√ß√£o** ao longo dos anos explicado anteriormente.

\
\
\
\




Calculo do tamanho amostral necess√°rio para estimar a m√©dia de acres das fazendas em 1992 com um erro m√°ximo B = 37191 acres e um n√≠vel de confian√ßa de 95%. Considere s = 344551,9 acres. Utilize os esquemas de AASc e AASs, compare os resultados.

\

- Esquema **AASc**

(*AASc: com reposi√ß√£o*)

Temos que o tamanho amostral √© determinado pela f√≥rmula: n = ùúé¬≤/(B/z)¬≤
Como n√£o possuimos o valor real de sigma quadrado vamos utilizar o estimador n√£o viciado s, e o B nos foi fornecido sendo B = 37191. E o valor de z a 95% √© 1.96, de acordo com a tabela da normal padr√£o.

```{r}
s = 344551.9
B = 37191
z = 1.96


nc = (s^2) / ((B/z)^2)
nc

# usando a formula de D tamb√©m da certo:
D = (B/z)^2
(s^2)/D

``` 
\

Com o esquema com reposi√ß√£o devemos ter uma amostra com 330 indiv√≠duos para obtermos os resultados desejados.

\
\
\

- Esquema **AASs**

(*AASs: sem reposi√ß√£o*)

Temos que o tamanho amostral √© determinado pela f√≥rmula:  n = N /( D/(N*(s^2))  +  1)

Lembrando que D na realidade √©: (B/z)^2.
O valor de *B, s e z* j√° foram garavdos anteriormente, e N √© a quantidade populacional cujo iremos retirar a amostra.


```{r}
D = (B/z)^2
N = length(agpop$acres92) #3078

ns = N / ( (D/(N*(s^2)))  +1 )
ns

```
\

Com o esquema com reposi√ß√£o obtivemos um n = 330, j√° no esquema sem reposi√ß√£o tivemos exatos n = 3078, que √© o valor do tamanho populacional. Os valores s√£o muito distantes, e em um aplica√ß√£o na realidade essa difern√ßa √© extramente siginificante pois o custo de se fazer uma amostragem √© proporcional ao tamanho a ser amostrado.

